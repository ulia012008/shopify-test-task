{% assign accordion_titles = product.metafields.custom.accordion_titles | split: "|" %}
{% assign accordion_contents = product.metafields.custom.accordion_contents | split: "|" %}

{% if accordion_titles.size > 0 and accordion_contents.size > 0 %}
  <div class="accordion">
    {% for title in accordion_titles %}
      {% assign index = forloop.index0 %}
      {% assign content = accordion_contents[index] %}
      {% if title != blank and content != blank %}
        <div class="accordion-item">
          <button class="accordion-title">{{ title }}</button>
          <div class="accordion-content">
            <p>{{ content }}</p>
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
{% endif %}

<style>
  .accordion-title { font-weight: bold; cursor: pointer; }
  .accordion-content { display: none; }
  .accordion-item.active .accordion-content { display: block; }
</style>

<script>
  document.querySelectorAll('.accordion-title').forEach(button => {
    button.addEventListener('click', () => {
      const item = button.parentElement;
      item.classList.toggle('active');
    });
  });
</script>
